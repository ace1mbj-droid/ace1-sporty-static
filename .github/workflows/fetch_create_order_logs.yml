name: Fetch create-order logs (temporary)

on:
  workflow_dispatch: {}

jobs:
  logs:
    runs-on: ubuntu-latest
    env:
      SUPABASE_PROJECT_REF: ${{ secrets.SUPABASE_PROJECT_REF }}
      SUPABASE_ACCESS_TOKEN: ${{ secrets.SUPABASE_ACCESS_TOKEN }}
    steps:
      - uses: actions/checkout@v4

      - name: Fetch create-order function logs
        run: |
          set -euo pipefail
          echo "Fetching most recent 200 logs for function: create-order"
          # newer CLI uses --project instead of --project-ref; add --debug to get more detail
          # use a recent CLI build (npx will download if needed) so `functions logs` and flags are available
          npx supabase@latest functions logs create-order --project-ref "$SUPABASE_PROJECT_REF" --token "$SUPABASE_ACCESS_TOKEN" --limit 200 --debug || true
